<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8" />
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-5770953-9', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J3K00HKL9D"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-J3K00HKL9D');
</script>
    

    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    <title>Batch-Jobs · JobRunr</title>

    

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <meta name="description" content="Mit Batch-Jobs können Sie eine Reihe von Hintergrundjobs atomar erstellen. Dies bedeutet, dass keine Ausnahme verarbeitet wird, wenn beim Erstellen von Hintergrundjobs eine Ausnahme aufgetreten ist. Stellen Sie sich vor, Sie möchten 1000 E-Mails an Ihre Kunden senden, und diese möchten diese E-Mails wirklich erhalten. Hier ist der alte Weg:
public class NewsletterService {   @Inject  private UserRepository userRepository;   public void sendEmailsToAllSubscribers() {  List&lt;User&gt; users = userRepository.">
    
    
    
    <meta name="author" content="Ronald Dehuysser, ronald@dehuysser.be">

    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:image" content="https://www.jobrunr.io/blog/2020-04-23-jobrunr-gets-jobs-done.webp" />
    <meta name="twitter:image:alt" content="JobRunr - get jobs done" />
    <meta name="twitter:title" content="Batch-Jobs" />
    <meta name="twitter:description" content="Mit Batch-Jobs können Sie eine Reihe von Hintergrundjobs atomar erstellen. Dies bedeutet, dass keine Ausnahme verarbeitet wird, wenn beim Erstellen von Hintergrundjobs eine Ausnahme aufgetreten ist. Stellen Sie sich vor, Sie möchten 1000 E-Mails an Ihre Kunden senden, und diese möchten diese E-Mails wirklich erhalten. Hier ist der alte Weg:
public class NewsletterService {   @Inject  private UserRepository userRepository;   public void sendEmailsToAllSubscribers() {  List&lt;User&gt; users = userRepository." />
    <meta name="twitter:creator" content="@rdehuyss" />
    <meta name="twitter:site" content="@jobrunr" />

    <meta property="og:title" content="Batch-Jobs" />
<meta property="og:description" content="Mit Batch-Jobs können Sie eine Reihe von Hintergrundjobs atomar erstellen. Dies bedeutet, dass keine Ausnahme verarbeitet wird, wenn beim Erstellen von Hintergrundjobs eine Ausnahme aufgetreten ist. Stellen Sie sich vor, Sie möchten 1000 E-Mails an Ihre Kunden senden, und diese möchten diese E-Mails wirklich erhalten. Hier ist der alte Weg:
public class NewsletterService {   @Inject  private UserRepository userRepository;   public void sendEmailsToAllSubscribers() {  List&lt;User&gt; users = userRepository." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.jobrunr.io/de/documentation/pro/batches/" /><meta property="og:image" content="https://www.jobrunr.io/blog/2020-04-23-jobrunr-gets-jobs-done.webp"/><meta property="article:section" content="documentation" />
<meta property="article:published_time" content="2020-08-27T11:12:23+02:00" />
<meta property="article:modified_time" content="2020-08-27T11:12:23+02:00" />



    
    
    
    <link rel="stylesheet" href="https://www.jobrunr.io/scss/custom.min.d3c8817355823d3ef8be81a95dc4872afe248c0196ea58f5645915fa773325ff.css" integrity="sha256-08iBc1WCPT74voGpXcSHKv4kjAGW6lj1ZFkV&#43;nczJf8=" media="screen">
    <link rel="stylesheet" href="https://www.jobrunr.io/scss/screen.min.bd3f9a99bf0e0f8300f9e46c85748d00e8675f1d2f18fe79254d76d1cb3cce5d.css" integrity="sha256-vT&#43;amb8OD4MA&#43;eRshXSNAOhnXx0vGP55JU120cs8zl0=" media="screen">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/themes/prism.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/themes/prism-coy.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css" />
</head>
<body class=" tag-template  ">

    <div class="site-wrapper">

<header class="site-header leftnav" style="height: 64px;"><div class="outer site-nav-main">
    <div class="inner"><nav id="site-nav" class="site-nav">
    <div class="site-nav-left">
        
        <a class="site-nav-logo" href="https://www.jobrunr.io/de/"><img src="https://www.jobrunr.io/images/jobrunr-logo-white.webp" alt="JobRunr" height="21px" width="91px"/></a>
        
        <div class="site-nav-content">
            <ul class="nav" role="menu">
                
                <li class="nav-home" role="menuitem"><a href="/de/">Home</a></li>
                
                <li class="nav-home" role="menuitem"><a href="/de/documentation/">Documentation</a></li>
                
                <li class="nav-home" role="menuitem"><a href="/de/pricing/">JobRunr Pro</a></li>
                
            </ul>
        </div>
    </div>
    <div class="site-nav-right">
        <div id="social-links" class="social-links">
            <style>
                div.social-links {
                    position: relative;
                }
                #lang-selector {
                    display: none;
                    background-color: rgb(144, 162, 170);
                    position: absolute;
                    left: 10px;
                    top: 56px;
                    z-index: 50;
                }
                #lang-selector li {
                    list-style-type: none;
                }
                #lang-selector li a {
                    color: #fff;
                    text-transform: uppercase;
                }
            </style>

            <a id="lang-link" class="social-link social-link-tw" style="color: #fff; text-transform: uppercase;" href="" title="Change language" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="-3 -3 32 32"><path d="M24 23h-2.784l-1.07-3h-4.875l-1.077 3h-2.697l4.941-13h2.604l4.958 13zm-4.573-5.069l-1.705-4.903-1.712 4.903h3.417zm-9.252-10.804c.126-.486.201-.852.271-1.212l-2.199-.428c-.036.185-.102.533-.22 1-.742-.109-1.532-.122-2.332-.041.019-.537.052-1.063.098-1.569h2.456v-2.083h-2.161c.106-.531.198-.849.288-1.149l-2.147-.645c-.158.526-.29 1.042-.422 1.794h-2.451v2.083h2.184c-.058.673-.093 1.371-.103 2.077-2.413.886-3.437 2.575-3.437 4.107 0 1.809 1.427 3.399 3.684 3.194 2.802-.255 4.673-2.371 5.77-4.974 1.134.654 1.608 1.753 1.181 2.771-.396.941-1.561 1.838-3.785 1.792v2.242c2.469.038 4.898-.899 5.85-3.166.93-2.214-.132-4.635-2.525-5.793zm-2.892 1.531c-.349.774-.809 1.543-1.395 2.149-.09-.645-.151-1.352-.184-2.107.533-.07 1.072-.083 1.579-.042zm-3.788.724c.062.947.169 1.818.317 2.596-1.996.365-2.076-1.603-.317-2.596z"/></svg>&nbsp;de</a>
            <ul id="lang-selector">
                
                <li>
                    <a href="https://www.jobrunr.io/en/documentation/pro/batches/">en</a>
                </li>
                
            </ul>
            <a class="social-link social-link-tw" href="https://github.com/jobrunr/website/tree/master/content/de/documentation/pro/batches.md" title="Edit this page on GitHub" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="-3 -3 32 32"><path d="M7.127 22.562l-7.127 1.438 1.438-7.128 5.689 5.69zm1.414-1.414l11.228-11.225-5.69-5.692-11.227 11.227 5.689 5.69zm9.768-21.148l-2.816 2.817 5.691 5.691 2.816-2.819-5.691-5.689z"/></svg></a>
            <a class="social-link social-link-tw" href="https://twitter.com/intent/follow?original_referer=https%3A%2F%2Fjobrunr.io&amp;screen_name=jobrunr&amp;tw_p=followbutton" title="Follow us on Twitter" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg></a>
            <a class="social-link social-link-gh" style="color: #fff" href="https://github.com/jobrunr/jobrunr" title="View code on Github" target="_blank" rel="noopener"><svg viewBox="-3 -3 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg> Source Code</a>
            <script>
                const langLink = document.getElementById("lang-link");
                const langSelector = document.getElementById("lang-selector");

                const hideLangSelector = () => {
                    langSelector.style.display = 'none';
                };
                
                const showLangSelector = () => {
                    langSelector.style.display = 'block';
                    setTimeout(hideLangSelector, 3000);
                };

                langLink.addEventListener("mouseover", showLangSelector);
            </script>
        </div>
    </div>
</nav>

</div>
</div></header>

<main id="site-main" class="site-main documentation outer">
    <div class="inner">
<aside>
    <ul>
        
        
            
        
            
                
                    <li class="">
                        <a href="/de/documentation/5-minute-intro/">
                            
                            5 Minuten Intro
                        </a>
                    </li>
                    <ul class="sub-menu">
                        
                    </ul>
                
                    <li class="">
                        <a href="/de/documentation/installation/">
                            
                            Installation
                        </a>
                    </li>
                    <ul class="sub-menu">
                        
                            <li class="">
                                <a href="/de/documentation/installation/storage/">Speicherung der Jobs</a>
                            </li>
                        
                    </ul>
                
                    <li class="">
                        <a href="/de/documentation/configuration/">
                            
                            Konfiguration
                        </a>
                    </li>
                    <ul class="sub-menu">
                        
                            <li class="">
                                <a href="/de/documentation/configuration/fluent/">Fließende API</a>
                            </li>
                        
                            <li class="">
                                <a href="/de/documentation/configuration/spring/">Spring Boot Starter</a>
                            </li>
                        
                            <li class="">
                                <a href="/de/documentation/configuration/quarkus/">Konfiguration für Quarkus</a>
                            </li>
                        
                    </ul>
                
                    <li class="">
                        <a href="/de/documentation/background-methods/">
                            
                            Hintergrundmethoden
                        </a>
                    </li>
                    <ul class="sub-menu">
                        
                            <li class="">
                                <a href="/de/documentation/background-methods/enqueueing-jobs/">Jobs einreihen</a>
                            </li>
                        
                            <li class="">
                                <a href="/de/documentation/background-methods/scheduling-jobs/">Jobs planen</a>
                            </li>
                        
                            <li class="">
                                <a href="/de/documentation/background-methods/recurring-jobs/">Wiederkehrende Jobs</a>
                            </li>
                        
                            <li class="">
                                <a href="/de/documentation/background-methods/passing-arguments/">Argumente übergeben</a>
                            </li>
                        
                            <li class="">
                                <a href="/de/documentation/background-methods/background-jobs-dependencies/">Hintergrundjob Abhängigkeiten</a>
                            </li>
                        
                            <li class="">
                                <a href="/de/documentation/background-methods/dealing-with-exceptions/">Umgang mit Ausnahmen</a>
                            </li>
                        
                            <li class="">
                                <a href="/de/documentation/background-methods/logging-progress/">Logging &amp; Auftragsfortschritt</a>
                            </li>
                        
                            <li class="">
                                <a href="/de/documentation/background-methods/best-practices/">Empfohlene Vorgehensweise</a>
                            </li>
                        
                    </ul>
                
                    <li class="active">
                        <a href="/de/documentation/pro/">
                            
                            JobRunr Pro
                        </a>
                    </li>
                    <ul class="sub-menu">
                        
                            <li class="">
                                <a href="/de/documentation/pro/queues/">Warteschlangen</a>
                            </li>
                        
                            <li class="">
                                <a href="/de/documentation/pro/job-chaining/">Job Chaining</a>
                            </li>
                        
                            <li class="active">
                                <a href="/de/documentation/pro/batches/">Batch-Jobs</a>
                            </li>
                        
                            <li class="">
                                <a href="/de/documentation/pro/server-tags/">Server Tags</a>
                            </li>
                        
                            <li class="">
                                <a href="/de/documentation/pro/mutexes/">Mutexe</a>
                            </li>
                        
                    </ul>
                
                    <li class="">
                        <a href="/de/documentation/faq/">
                            
                            FAQ
                        </a>
                    </li>
                    <ul class="sub-menu">
                        
                    </ul>
                
            
        
            
        
    </ul>
</aside><article class="post-full post no-image no-image">
            <header class="post-full-header">
                <h1 class="post-full-title">Batch-Jobs</h1>
                
                    <p class="post-full-custom-excerpt"> Mit Batch-Jobs können Sie eine Reihe von Hintergrundjobs atomar erstellen.</p>
                
            </header>
            <section class="post-full-content">
                <p>Mit Batch-Jobs können Sie eine Reihe von Hintergrundjobs atomar erstellen. Dies bedeutet, dass keine Ausnahme verarbeitet wird, wenn beim Erstellen von Hintergrundjobs eine Ausnahme aufgetreten ist. Stellen Sie sich vor, Sie möchten 1000 E-Mails an Ihre Kunden senden, und diese möchten diese E-Mails wirklich erhalten. Hier ist der alte Weg:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NewsletterService</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">@Inject</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span> UserRepository userRepository<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">sendEmailsToAllSubscribers</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      List<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> users <span style="color:#f92672">=</span> userRepository<span style="color:#f92672">.</span><span style="color:#a6e22e">getAllUsers</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">for</span><span style="color:#f92672">(</span>User user <span style="color:#f92672">:</span> users<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>          BackgroundJob<span style="color:#f92672">.</span><span style="color:#a6e22e">enqueue</span><span style="color:#f92672">(()</span> <span style="color:#f92672">-&gt;</span> mailService<span style="color:#f92672">.</span><span style="color:#a6e22e">send</span><span style="color:#f92672">(</span>user<span style="color:#f92672">.</span><span style="color:#a6e22e">getId</span><span style="color:#f92672">(),</span> <span style="color:#e6db74">&#34;mail-template-key&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>Was aber, wenn der Speicher nicht mehr verfügbar ist, nachdem die Hälfte aller E-Mails an die Benutzer gesendet wurde? Diese E-Mails werden möglicherweise bereits gesendet, da Worker-Threads Aufträge abrufen und verarbeiten, sobald sie erstellt wurden. Wenn Sie diesen Code erneut ausführen, erhalten einige Ihrer Clients möglicherweise störende Duplikate. Wenn Sie damit richtig umgehen möchten, sollten Sie mehr Code schreiben, um zu verfolgen, welche E-Mails gesendet wurden.</p>
<p><strong>Aber hier ist eine viel einfachere Methode:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NewsletterService</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">@Inject</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span> UserRepository userRepository<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">sendEmailsToAllSubscribers</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      BackgroundJob<span style="color:#f92672">.</span><span style="color:#a6e22e">startBatch</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">::</span>sendEmailToEachSubscriber<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">sendEmailToEachSubscriber</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      List<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> users <span style="color:#f92672">=</span> userRepository<span style="color:#f92672">.</span><span style="color:#a6e22e">getAllUsers</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">for</span><span style="color:#f92672">(</span>User user <span style="color:#f92672">:</span> users<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>          BackgroundJob<span style="color:#f92672">.</span><span style="color:#a6e22e">enqueue</span><span style="color:#f92672">(()</span> <span style="color:#f92672">-&gt;</span> mailService<span style="color:#f92672">.</span><span style="color:#a6e22e">send</span><span style="color:#f92672">(</span>user<span style="color:#f92672">.</span><span style="color:#a6e22e">getId</span><span style="color:#f92672">(),</span> <span style="color:#e6db74">&#34;mail-template-key&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><br>
<h4 id="wie-funktioniert-es">Wie funktioniert es?</h4>
<ul>
<li>Alle untergeordneten Jobs (<code>mailService.send(UUID userId, String mailTemplateKey)</code>) werden nicht im Status <code>ENQUEUED</code> gespeichert, sondern im Status <code>AWAITING</code>.</li>
<li>Im Falle einer Ausnahme, während alle Jobs in die Warteschlange gestellt werden, um E-Mails an die verschiedenen Benutzer zu senden, wird der <code>sendEmailToEachSubscriber</code> (der übergeordnete Job) dank des &ldquo;RetryFilter&rdquo; ebenfalls automatisch wiederholt. Es werden jedoch zuerst alle untergeordneten Jobs gelöscht, die sich im Status &ldquo;WARTEN&rdquo; befinden, wodurch die Möglichkeit verhindert wird, E-Mails zweimal zu senden.</li>
<li>Wenn der übergeordnete Job (<code>newsletterService.sendEmailToEachSubscriber ()</code>) erfolgreich abgeschlossen wurde, werden alle untergeordneten Jobs in den Status <code>ENQUEUED</code> aktualisiert und beginnen mit der Verarbeitung.</li>
</ul>
<blockquote>
<p>Damit Batch-Jobs funktionieren, ist es wichtig, dass Sie zuerst einen übergeordneten Job planen (in diesem Fall <code>BackgroundJob.startBatch(this::sendEmailToEachSubscriber)</code>) und erst dann die untergeordneten Jobs in einer anderen Methode planen.</p>
</blockquote>
<p><strong>Beachten Sie, dass Folgendes nicht funktioniert:</strong></p>
<figure>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NewsletterService</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Inject</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> UserRepository userRepository<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">sendEmailToAllSubscribers</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        BackgroundJob<span style="color:#f92672">.</span><span style="color:#a6e22e">startBatch</span><span style="color:#f92672">(()</span> <span style="color:#f92672">-&gt;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            List<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> users <span style="color:#f92672">=</span> userRepository<span style="color:#f92672">.</span><span style="color:#a6e22e">getAllUsers</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span><span style="color:#f92672">(</span>User user <span style="color:#f92672">:</span> users<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                BackgroundJob<span style="color:#f92672">.</span><span style="color:#a6e22e">enqueue</span><span style="color:#f92672">(()</span> <span style="color:#f92672">-&gt;</span> mailService<span style="color:#f92672">.</span><span style="color:#a6e22e">send</span><span style="color:#f92672">(</span>user<span style="color:#f92672">.</span><span style="color:#a6e22e">getId</span><span style="color:#f92672">(),</span> <span style="color:#e6db74">&#34;mail-template-key&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">});</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><figcaption> Dieses Beispiel funktioniert nicht, da JobRunr kein Lambda innerhalb eines Lambda analysieren kann. </figcaption>
</figure>
<h2 id="batchen-verketten">Batchen verketten</h2>
<p>Mit Fortsetzungen können Sie mehrere Stapel miteinander verketten. Sie werden ausgeführt, sobald alle Hintergrundjobs eines übergeordneten Stapels abgeschlossen sind. Betrachten Sie das vorherige Beispiel, in dem Sie 1000 E-Mails senden müssen. Wenn Sie nach dem Senden eine endgültige Aktion ausführen möchten, fügen Sie einfach eine Fortsetzung hinzu:</p>
<figure>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NewsletterService</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Inject</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> UserRepository userRepository<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Inject</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> ReportService reportService<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Inject</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> NotifyService notifyService<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">sendCampaingEmailToAllSubscribers</span><span style="color:#f92672">(</span>String campaignId<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        String campaignReportLocation <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/path/to/campaign/report/&#34;</span> <span style="color:#f92672">+</span> campaignId <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.csv&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        BackgroundJob
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">.</span><span style="color:#a6e22e">startBatch</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">::</span>sendEmailToEachSubscriber<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">.</span><span style="color:#a6e22e">continueWith</span><span style="color:#f92672">(()</span> <span style="color:#f92672">-&gt;</span> reportService<span style="color:#f92672">.</span><span style="color:#a6e22e">createReportForCampaign</span><span style="color:#f92672">(</span>campaignId<span style="color:#f92672">,</span> campaignReportLocation<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">.</span><span style="color:#a6e22e">continueWith</span><span style="color:#f92672">(()</span> <span style="color:#f92672">-&gt;</span> notifyService<span style="color:#f92672">.</span><span style="color:#a6e22e">notifyViaSlack</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;sales-team&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Successfully sent newsletter for campaign &#34;</span> <span style="color:#f92672">+</span> campaignId<span style="color:#f92672">,</span> campaignReportLocation<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">sendEmailToEachSubscriber</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> users <span style="color:#f92672">=</span> userRepository<span style="color:#f92672">.</span><span style="color:#a6e22e">getAllUsers</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span><span style="color:#f92672">(</span>User user <span style="color:#f92672">:</span> users<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            BackgroundJob<span style="color:#f92672">.</span><span style="color:#a6e22e">enqueue</span><span style="color:#f92672">(()</span> <span style="color:#f92672">-&gt;</span> mailService<span style="color:#f92672">.</span><span style="color:#a6e22e">send</span><span style="color:#f92672">(</span>user<span style="color:#f92672">.</span><span style="color:#a6e22e">getId</span><span style="color:#f92672">(),</span> <span style="color:#e6db74">&#34;mail-template-key&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><figcaption>
<p>Das Verkaufsteam wird auf Slack erst dann mit einem netten Bericht benachrichtigt, wenn jeder Abonnent eine E-Mail erhalten hat. Der zweite Job (<code>reportService.createReportForCampaign (String CampaignId, String CampaignReportLocation)</code>) wird nur ausgeführt, wenn die E-Mail erfolgreich an alle Abonnenten gesendet wurde. Der dritte Job (<code>notifyService.notifyViaSlack (String-Kanal, String-Nachricht, String-Anhangsstandort)</code>) wird nur ausgeführt, wenn der zweite Job erfolgreich war.</p>
</figcaption>
</figure>
<p>Mit Batch-Jobs und Batch-Fortsetzungen können Sie Workflows definieren und konfigurieren, welche Aktionen parallel ausgeführt werden. Dies ist sehr nützlich für umfangreiche Berechnungsmethoden, da diese auf verschiedene Maschinen verteilt werden können.</p>
<h2 id="komplexe-workflows">Komplexe Workflows</h2>
<p>Mit JobRunr können Sie komplexe Workflows erstellen. Innerhalb eines Stapeljobs können Sie Jobs so planen, dass sie später ausgeführt werden, Fortsetzungen hinzufügen, Fortsetzungen zu Fortsetzungen hinzufügen usw.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">aComplexWorkflow</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    String campaignReportLocation <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/path/to/campaign/report/&#34;</span> <span style="color:#f92672">+</span> campaignId <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.csv&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    BackgroundJob
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span><span style="color:#a6e22e">startBatch</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">::</span>step1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span><span style="color:#a6e22e">continueWith</span><span style="color:#f92672">(()</span> <span style="color:#f92672">-&gt;</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Step 2 which will only run after Step 1 completely succeeded&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">step1</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  BackgroundJob<span style="color:#f92672">.</span><span style="color:#a6e22e">enqueue</span><span style="color:#f92672">(()</span> <span style="color:#f92672">-&gt;</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Step 1A of batch&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>  BackgroundJob
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">.</span><span style="color:#a6e22e">schedule</span><span style="color:#f92672">(()</span> <span style="color:#f92672">-&gt;</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Step 1B of batch which will run tomorrow&#34;</span><span style="color:#f92672">),</span> now<span style="color:#f92672">().</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>24<span style="color:#f92672">,</span> HOURS<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">.</span><span style="color:#a6e22e">continueWith</span><span style="color:#f92672">(()</span> <span style="color:#f92672">-&gt;</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Step 1C of batch which will run just after Step 1B has succeeded&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h2 id="dashboard">Dashboard</h2>
<p>Dank des erweiterten Dashboards, das mit JobRunr Pro geliefert wird, haben Sie einen detaillierten Überblick über alle Ihre verschiedenen Stapeljobs.</p>
<figure>
<img src="/documentation/jobrunr-pro-batches.webp" class="kg-image">
<figcaption> Die Pro-Version bietet auch einen Überblick über alle Ihre Stapel </figcaption>
</figure>
<figure>
<img src="/documentation/jobrunr-pro-batch-details.webp" class="kg-image">
<figcaption> Verfolgen Sie Ihre Stapeljobs dank der erweiterten Jobdetails eines Stapeljobs </figcaption>
</figure>
<figure>
<img src="/documentation/jobrunr-pro-batch-details-processing.webp" class="kg-image">
<figcaption> Die Registerkarte Verarbeitung in einem Stapeljob zeigt an, welche untergeordneten Jobs verarbeitet werden </figcaption>
</figure>
            </section>
        </article>
        
    </div>
</main>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright">
                  &copy; <a href="https://www.jobrunr.io">JobRunr</a>
                </section>
                <section class="love" style="opacity: 0.7;">
                  Made with <strong style="color: red; font-size: large;">&hearts;</strong> in Belgium
                </section>
                <nav class="site-footer-nav">
                    <div><a href="/en/about/" rel="noopener" style="opacity: 0.5;">JobRunr by Ronald Dehuysser</a></div>
                    <a href="https://jonathanjanssens.com" target="_blank" rel="noopener" style="opacity: 0.5;">Hugo Casper3 by Jonathan Janssens</a>
                </nav>
            </div>
        </footer>
    </div>

    
    <script src="https://www.jobrunr.io/js/jobrunr-version.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/components/prism-java.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script>
<script>
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#000"
    },
    "button": {
      "background": "transparent",
      "border": "#fff",
      "text": "#fff"
    }
  },
  "content": {
    "link": "Learn more about cookies"
  }
});

var links = document.querySelectorAll('a');
for (var i = 0; i < links.length; i++) {
  if (links[i].hostname != window.location.hostname) {
    links[i].target = '_blank';
    links[i].rel = 'noopener';
  }
}
</script>
</body>
</html>